<h1>Vulnerability Management with Nessus</h1>



<h2>Description</h2>
In this project I will walkthrough vulnerability scanning and vulnerability remediation. I will be using Nessus Essentials to scan local VMs hosted on VMWare Workstation in order run credentialed scans to discover vulnerabilities, remediate some of the vulnerabilities, then perform a rescan to verify remediation. <br />


<h2>Languages, Utilities, Enviorments </h2>

- <b>VMware</b> 
- <b>Nessus Essentials</b>
- <b>Windows 10 ISO</b>



<h2>Lab walk-through:</h2>

<p align="center">
<b>Download and install Nessus Essentials:<b> <br/>
<img src="download_install_nessus.png" height="80%" width="80%" alt="Setup-SIEM-for-Sentinel"/>
</p>
- I downloaded and installed nessus by registering for a free account and recieved an activation code by email.
<br />
<br />
<p align="center">
<b>Sign in to Nessus and save URL:<b> <br/>
<img src="signin_nessus.png" height="100%" width="100%" alt="Setup-SIEM-for-Sentinel"/>
</p>
- I saved the URL for Nessus in a notepad as I will be using it in case of session loss or I close the browser by accident
<br />
<br />
<p align="center">
<b>Set up virtual machine and install Windows 10 iso:<b> <br/>
<img src="newVM1.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
</p>
<br />
- Downloaded VMware (virtualization)
<br />
- Installed windows 10
<br />
- Setup default admin username and password
<br />
<br />
<p align="center">
<b>Ping VM from local machine to ensure connectivity:<b> <br/>
<img src="pingvm.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<p/>
- In able to run the scan, my local machine has to be able to reach the VM
<br />
- For this lab, I disabled the virtual machines firewall (wont do for corporate enviorment)
<br />
<br />
<p align="center">
<b>Create new basic scan in Nessus:<b> <br/>
<img src="create_newscan.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
</p>
- I copied the vm's IP address and plugged it into Nessus
<br />
<br />
<p align="center">
<b>Observing first scan (without credentials):<b> <br/>
<img src="basicscan.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<img src="basicVM_vulnerabilities.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<img src="basicscanSMB.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
</p>
<br />
- After running the first scan (without credentials), the vulnerabilities that were found medium and info. <br />
- Doing a basic scan won't be much use as the scanner does not have admin credentials to scan registry files and such <br />
- I will be setting that up next <br />
<br />
<p align="center">
<b>Configuring VM for credentialed scans:<b> <br/>
<b>Enable remote registry:<b> <br/>
<img src="enable_remote_serv.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
- To allow our scanner access the vm's regisry files, I have to enable remote registry.
<br />
<br />
<p align="center">
<b>Add LocalAccountTokenFilterPolicy<b> <br/>
<img src="local_accnt_polic.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> </p>
- Disable UAC remote restrictions <br/>
- Pathway: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System <br/>
- Create new D-word LocalAccountTokenFilterPolicy <br/>
- Set value to 1 <br/>
<br />
<br />
<p align="center">
<b>Configure credentials in Nessus :<b> <br/>
<img src="configure_credentials.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- Clicked on my scans and checked the box for my scan <br />
- Clicked on configure then went to credentials <br />
- Added the windows credentials setting <br />
- entered vm's admin username and password and clicked saved <br />
<br />
<p align="center">
<b>Running first scan (with credentials):<b> <br/>
<img src="credentialed_scan.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
<br />
<br />
<p align="center">
<b>Observing first scan (with credentials):<b> <br/>
<img src="vulnerabilitiescred.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<img src="vulnerabilities.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- After running the credentialed scan, there are alot more high and critical vulnerabilities <br />
- They mostly have to do with OS not having the proper security patches and updates.
<br />
<br />
<p align="center">
<b>Installing old software:<b> <br/>
<img src="old_firefox.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> </p>
- Here  I downloaded  and installed an old version of the web browser FireFox
<br />
<br />
<p align="center">
<b>Run new scan after old web browser is installed:<b> <br/>
<img src="credentialed_scanfirefx.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- More critical vulnerabilities now that the old version of FireFox is installed
<br />
<br />
<p align="center">
<b>Inspect new scan:<b> <br/>
<img src="mixed_vuln.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<img src="firefox_critical2.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<img src="firefox_critical.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- After inspecting the results, it shows that the installation of this version of firefox has many critical vulnerabilities that 
  hackers can use to attack and exploit the system.
<br />
<p align="center">
<b>Remediation:<b> <br/>
<img src="remed.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- This screenshot shows the remediation tab in our scan <br />
- The two recommended remediations are installing KB5035845 and upgrade FireFox <br />
<br />
<p align="center">
<b>Update or Uninstall software:<b> <br/>
<img src="uninstall_firefox.png" height="80%" width="80%" alt="Disk Sanitization Steps"/> </p>
- Here I will be uninstalling the old web browser Firefox instead of updating the software <br />
<br />
<p align="center">
<b>Run Windows updates:<b> <br/>
<img src="update_windows1.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="update_windows2.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
- After the software had been uninstalled, I ran windows updates until there the system was completely updated. <br/>
<br/>
<p align="center">
<b>Run new scan after remediations:<b> <br/>
<img src="updated_windowsScan.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- After VM was updated, I ran another scan to see the results <br />
- Most of the critical vulnerabilities has been remediated due to system updates and uninstalling of depreciated software.
<br />
<br />
<p align="center">
<b>Inspecting scan results:<b> <br/>
<img src="updated_windowsScan2.png" height="100%" width="100%" alt="Disk Sanitization Steps"/> </p>
- There are more vulnerabilities on the system that I could go through and remediate such as Microsoft Internet Explorer being updated.
<br />
<br />
<p align="center">
<b>After thoughts:<b> <br/>
</p>
- In conclusion, by doing this project I gained some expiereince of Nessus Essentials, virtualization using VMware, vulnerability scanning and remediation.
<br />
- This concludes my lab. Thank you!
<br />

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
